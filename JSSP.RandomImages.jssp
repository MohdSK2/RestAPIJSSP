!function(){function e(e,a,s,r){return new Promise(((o,i)=>{var n=new XMLHttpRequest;n.onreadystatechange=function(){try{if(4!==n.readyState)return;if(200!==n.status&&404!=n.status)throw new Error("Failed with status "+n.status+" statustext: "+n.statusText);r(n),o()}catch(e){console.log("executexhr error: "+e+" xhr.responseText: "+n.responseText),i(e)}},n.onerror=function(){Error("Failed with status "+n.status),t("executexhr onerror: Failed with status "+n.status,"HTTP Respnonse",e),i(new Error("Failed with status "+n.status))},console.log("executexhr "+a+" url: "+s),n.open(a,s),n.setRequestHeader("content-type","application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8"),n.send()}))}function t(e,t,a){"true"==a.DEBUG&&console.log(`ERROR: ${t}\r\n${e}`)}var a={displayName:"Random Images",description:"Return random images",properties:{id:{displayName:"id",type:"string",description:"id"},author:{displayName:"author",type:"string",description:"author"},width:{displayName:"width",type:"number",description:"width"},height:{displayName:"height",type:"number",description:"name"},url:{displayName:"url",type:"string",description:"url"},download_url:{displayName:"download_url",type:"string",description:"download_url"}},methods:{GetImages:{displayName:"Get Images",type:"list",inputs:[],outputs:["id","author","width","height","url","download_url"]},GetImage:{displayName:"Get Image",type:"read",inputs:["id"],requiredInputs:["id"],outputs:["id","author","width","height","url","download_url"]}}};async function s(a,s,r,o){switch(a){case"GetImages":await async function(a,s,r){return new Promise((async(a,s)=>{try{let s,i={},n=[];var o=new XMLHttpRequest;let d,u=e=>{if(200===(o=e).status)return s=JSON.parse(o.responseText),s.forEach((e=>{i={id:e.id,author:e.author,width:e.width,height:e.height,url:e.url,download_url:e.download_url},n.push(i)})),console.log(n),postResult(n),void a();400===o.status&&(t(s.error.message,"RandomImages.onexecuteGetImages",r),a())};d=`${r.K2BaseUrl}/v2/list`,await e(r,"GET",d,u)}catch(e){t(`${e.message} \rError stack:${e.stack}`,"RandomImages.onexecuteGetImages",r),s(e)}}))}(0,0,o);break;case"GetImage":await async function(a,s,r){return new Promise((async(s,o)=>{try{let o,n={};var i=new XMLHttpRequest;let d,u=e=>{if(200===(i=e).status)return o=JSON.parse(i.responseText),n={id:o.id,author:o.author,width:o.width,height:o.height,url:o.url,download_url:o.download_url},console.log(n),postResult(n),void s();400===i.status&&(t(o.error.message,"RandomImages.onexecuteGetImage",r),s())};d=void 0!==a.id&&null!==a.id?`${r.K2BaseUrl}/id/${a.id}/info`:`${r.K2BaseUrl}/id/0/info`,await e(r,"GET",d,u)}catch(e){t(`${e.message} \rError stack:${e.stack}`,"RandomImages.onexecuteGetImage",r),o(e)}}))}(s,0,o);break;default:throw new Error(`The method ${a} is not supported.`)}}metadata={systemName:"com.k2.RandomImages",displayName:"JSSP - RandomImages",description:"JSSP - RandomImages",configuration:{MSGraphAPIURL:{displayName:"MS Graph API URL",type:"string",value:"https://graph.microsoft.com/v1.0/",required:!0},K2BaseUrl:{displayName:"K2 Base URL",type:"string",value:"https://picsum.photos",required:!0},DEBUG:{displayName:"DEBUG",type:"boolean",value:!0}}},ondescribe=async function({configuration:e}){console.log("ondescribe"),postSchema({objects:{RandomImages:a}})},onexecute=async function({objectName:e,methodName:t,parameters:a,properties:r,configuration:o}){switch(e){case"RandomImages":await s(t,r,0,o);break;default:throw new Error("The object "+e+" is not supported.")}}}();
//# sourceMappingURL=JSSP.RandomImages.jssp.map
